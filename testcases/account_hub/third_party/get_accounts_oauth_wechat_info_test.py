# NOTE: Generated By HttpRunner v4.3.5
# FROM: .\testcases\account_hub\third_party\get_accounts_oauth_wechat_info.yml
import pytest

from httprunner import HttpRunner, Config, Step, RunRequest
from httprunner import Parameters


class TestCaseGetAccountsOauthWechatInfo(HttpRunner):
    @pytest.mark.parametrize(
        "param",
        Parameters(
            {
                "name-user_id-status_code-msg": [
                    ["批量获取用户微信信息 - 查询单个用户的微信信息", [10000], 200, "unionid"],
                    ["批量获取用户微信信息 - 查询多个用户的微信信息", [10000, "$u_id"], 200, "unionid"],
                    ["批量获取用户微信信息 - 查询没有绑定微信用户的微信信息", [1000], 200, ""],
                ]
            }
        ),
    )
    def test_start(self, param):
        super().test_start(param)

    config = (
        Config("/accounts/oauth/wechat/info批量获取用户微信信息")
        .variables(**{"url": "${ENV(BASE_URL)}", "u_id": "${ENV(ENV_USER_ID)}"})
        .base_url("${ENV(BASE_URL)}")
    )

    teststeps = [
        Step(
            RunRequest("$name")
            .post("/accounts/oauth/wechat/info")
            .with_json({"user_ids": "$user_id"})
            .validate()
            .assert_equal("status_code", "$status_code")
            .assert_contains("text", "$msg")
        ),
    ]


if __name__ == "__main__":
    TestCaseGetAccountsOauthWechatInfo().test_start()
